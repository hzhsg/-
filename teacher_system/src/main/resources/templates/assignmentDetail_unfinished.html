<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
  <!--<![endif]-->
  <!-- Begin Head -->
  <head>
    <title>作业详情-未完成</title>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="author" content="" />
    <meta name="MobileOptimized" content="320" />
    <!--Start Style -->
    <link rel="stylesheet" type="text/css" href="static/css/fonts.css" />
    <link
      rel="stylesheet"
      type="text/css"
      href="static/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="static/css/font-awesome.min.css"
    />
    <link rel="stylesheet" type="text/css" href="static/css/icofont.min.css" />
    <link rel="stylesheet" type="text/css" href="static/css/style.css" />
    <link rel="stylesheet" id="theme-change" type="text/css" href="" />
    <script src="https://unpkg.com/axios@1.1.2/dist/axios.min.js"></script>
  </head>

  <body>
    <!-- Main Body -->
    <div class="page-wrapper">
      <!-- Header Start -->
      <header class="header-wrapper main-header">
        <div class="header-inner-wrapper">
          <div class="logo-wrapper">
            <a href="" class="admin-logo">
              <img src="static/picture/title.png" alt="" />
            </a>
          </div>
          <div class="header-right">
            <div class="serch-wrapper">
              <form>
                <input type="text" placeholder="Search Here..." />
              </form>
              <a class="search-close" href="javascript:void(0);"
                ><span class="icofont-close-line"></span></a>
            </div>
            <div class="header-left">
              <div class="header-links">
                <a href="javascript:void(0);" class="toggle-btn">
                  <span></span>
                </a>
              </div>
            </div>
            <div class="header-controls">

              <div class="user-info-wrapper header-links">
                <a href="javascript:void(0);" class="user-info">
                  <img src="static/picture/image.jpg" alt="" class="user-img"/>
                </a>
                <div class="user-info-box">
                  <div class="drop-down-header">
                    <h4 th:text="${name}">huzhihang</h4>
                    <p>教师</p>
                  </div>
                  <ul>
                    <li>
                      <a href="profile">
                        <i class="far fa-edit"></i> 个人信息
                      </a>
                    </li>
                    <li>
                      <form action="doLogout" method="post">
                        <button type="submit">
                          <i class="fas fa-sign-out-alt"></i> logout
                        </button>
                      </form>
                    </li>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>
      <!-- Sidebar Start -->
      <aside class="sidebar-wrapper">
        <div class="side-menu-wrap">
          <ul class="main-menu">
            <li>
              <a href="/" class="active">
                <span class="icon-menu feather-icon">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewbox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="feather feather-home"
                  >
                    <path
                      d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
                    ></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                  </svg>
                </span>
                <span class="menu-text"> 首页 </span>
              </a>
            </li>
            <li>
              <a href="course">
                <span class="icon-menu feather-icon">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewbox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="feather feather-users"
                  >
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                  </svg>
                </span>
                <span class="menu-text"> 课程 </span>
              </a>
            </li>
            <li>
              <a href="assignment">
                <span class="icon-menu feather-icon">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewbox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="feather feather-layers"
                  >
                    <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
                    <polyline points="22 17 12 22 2 17"></polyline>
                    <polyline points="2 12 12 17 22 12"></polyline>
                  </svg>
                </span>
                <span class="menu-text"> 作业 </span>
              </a>
            </li>
            <li>
              <a href="notification">
                <span class="icon-menu feather-icon">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewbox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="feather feather-mail"
                  >
                    <path
                      d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"
                    ></path>
                    <polyline points="22,6 12,13 2,6"></polyline>
                  </svg>
                </span>
                <span class="menu-text"> 通知 </span>
              </a>
            </li>
          </ul>
        </div>
      </aside>
      <!-- Container Start -->
      <div class="page-wrapper">
        <div class="main-content">
          <!-- Page Title Start -->
          <div class="row">
            <div class="colxl-12 col-lg-12 col-md-12 col-sm-12 col-12">
              <div class="page-title-wrapper">
                <div class="page-title-box ad-title-box-use">
                  <h4 th:text="${title}" class="page-title bold"></h4>
                  <p th:text="${assignmentDescription}"></p>
                </div>
                <div class="ad-breadcrumb">
                  <div class="add-group">
                    <input type="text" id="assignmentId" th:value="${assignmentId}" hidden>
                    <a href="javascript:getAssignment();" class="ad-btn">编辑作业</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Table Start -->
          <div class="row">
            <!-- Styled Table Card-->
            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
              <div class="card table-card">
                <ul>
                  <li class="container-grid">
                    <div class="card-header pb-0" style="text-align: center;">
                      <h4>作业列表</h4>
                      <a href="assignmentDetail_finished" class="btn btn-primary mt-2 float-left mr-2">已完成</a>
                    </div>
                  </li>
                </ul>
                <style>
                  .container-grid {
                    display: grid;
                    grid-template-columns: 1fr auto; /* 定义两列，第一列为1fr（flex fraction），第二列为自动大小 */
                    align-items: center; /* 垂直居中 */
                  }
                  .add-group {
                    text-align: right; /* 文本右对齐 */
                  }
                </style>

                <div class="card-body">
                  <div class="chart-holder">
                    <div class="table-responsive">
                      <table class="table table-styled mb-0">
                        <thead>
                          <tr>
                            <th>学号</th>
                            <th>学生昵称</th>
                            <th>提交状态</th>
                          </tr>
                          </thead>
                          <tbody>
                          <tr th:each="submission:${submissionList}" th:data-submission-id="${submission.getSubmission_id()}">
                            <td th:text="${submission.getStudent_id()}"></td>
                            <td th:if="${submission.getStudent_name()}" th:text="${submission.getStudent_name()}"></td>
                            <td th:unless="${submission.getStudent_name()}" th:text="${submission.getStudent_username()}"></td>
                            <td th:if="${submission.isSubmission_status()}" th:style="'color: green;'">已提交</td>
                            <td th:unless="${submission.isSubmission_status()}" th:style="'color: red;'">未提交</td>
                          </tr>
                          <!-- Additional rows omitted for brevity -->
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Slide Setting Box -->
    <!-- Model -->
    <!-- Script Start -->
    <!-- 编辑作业模态框 -->
    <div class="modal fade" id="editAssignmentModal" tabindex="-1" role="dialog" aria-labelledby="editAssignmentModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editAssignmentModalLabel">编辑作业</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form>
              <div class="form-group">
                <label for="editAssignmentName">作业标题</label>
                <input type="text" class="form-control" id="editAssignmentName" placeholder="输入作业标题" required>
              </div>
              <div class="form-group">
                <label for="editAssignmentDescription">作业描述</label>
                <textarea class="form-control" id="editAssignmentDescription" rows="3" placeholder="输入作业描述"></textarea>
              </div>
              <div class="form-group">
                <label for="editAssignmentDeadline">截止时间</label>
                <input type="datetime-local" class="form-control" id="editAssignmentDeadline" placeholder="选择截止时间" required>
              </div>
              <input type="hidden" id="editAssignmentId">
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
            <button onclick="editAssignment()" type="button" class="btn btn-primary">保存</button>
          </div>
        </div>
      </div>
    </div>

    <script src="static/js/jquery.min.js"></script>
    <script src="static/js/popper.min.js"></script>
    <script src="static/js/bootstrap.min.js"></script>
    <script src="static/js/custom.js"></script>
  </body>
</html>

<script>
  function getAssignment() {
    // 使用axios向后端发送请求，获取课程数据
    axios.post('/getAssignment',{
      assignmentId:document.getElementById('assignmentId').value
    },{
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      }
    }).then(({data})=> {
      var deadline = data.deadline;
      // 移除毫秒和时区信息，只保留日期和时间部分
      deadline = deadline.slice(0,16);

      // 填充模态框数据
      document.getElementById('editAssignmentName').value = data.title;
      document.getElementById('editAssignmentDescription').value = data.description;
      document.getElementById('editAssignmentDeadline').value = deadline;
      document.getElementById('editAssignmentId').value = data.assignment_id;

      // 显示模态框
      $('#editAssignmentModal').modal('show');
    })
  }

  function editAssignment() {
    axios.post('/editAssignment',{
      assignmentId:document.getElementById('editAssignmentId').value,
      assignmentName:document.getElementById('editAssignmentName').value,
      assignmentDescription:document.getElementById('editAssignmentDescription').value,
      assignmentDeadline:document.getElementById('editAssignmentDeadline').value
    },{
      headers:{
        'Content-Type':'application/x-www-form-urlencoded'
      }
    }).then(({data})=>{
      alert(data);
      if(data==='编辑作业成功'){
        $('#editAssignmentModal').modal('hide');
        window.location.reload();
      }
    })
  }
</script>
